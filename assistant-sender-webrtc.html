<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <title>ì¡°ìˆ˜ìš© ì†¡ì‹  ì•± - WebRTC</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      touch-action: none;
      overflow: hidden;
    }
    body.fullscreen-mode {
      background: #1a3a1a;
      padding: 0;
    }
    .container { max-width: 600px; margin: 0 auto; transition: all 0.5s ease; }
    .container.fullscreen { max-width: 100%; margin: 0; }
    
    /* ì—°ê²° ìƒíƒœ í—¤ë” */
    .header {
      background: white;
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      transition: all 0.5s ease;
    }
    .header.hidden { 
      opacity: 0; 
      transform: translateY(-20px); 
      pointer-events: none;
      position: absolute;
      z-index: -1;
    }
    .header h1 { font-size: 24px; color: #333; margin-bottom: 15px; }
    
    .connection-box {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .connection-code {
      text-align: center;
      padding: 15px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 10px;
      margin-bottom: 10px;
    }
    .code-label {
      color: white;
      font-size: 14px;
      opacity: 0.9;
      margin-bottom: 5px;
    }
    .code-value {
      color: white;
      font-size: 36px;
      font-weight: bold;
      letter-spacing: 8px;
      font-family: 'Courier New', monospace;
    }
    
    .connection-status {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px;
      background: white;
      border-radius: 8px;
    }
    .status-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ccc;
      transition: all 0.3s ease;
    }
    .status-dot.waiting { background: #ffa500; box-shadow: 0 0 10px #ffa500; animation: blink 1.5s infinite; }
    .status-dot.connected { background: #00ff00; box-shadow: 0 0 10px #00ff00; animation: pulse 2s infinite; }
    .status-text { font-size: 14px; color: #666; flex: 1; }
    
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
    
    .network-guide {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 12px;
      border-radius: 8px;
      font-size: 13px;
      color: #1976d2;
      line-height: 1.6;
    }

    /* ìº”ë²„ìŠ¤ ì˜ì—­ */
    .canvas-container {
      background: white;
      border-radius: 15px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      transition: all 0.5s ease;
    }
    .canvas-container.fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      border-radius: 0;
      padding: 0;
      margin: 0;
      background: #1a3a1a;
      z-index: 1000;
    }
    .canvas-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      transition: all 0.5s ease;
    }
    .canvas-header.hidden {
      opacity: 0;
      height: 0;
      margin: 0;
      overflow: hidden;
    }
    .canvas-header h2 { font-size: 18px; color: #333; }
    .tool-buttons { display: flex; gap: 10px; }
    .tool-btn {
      padding: 8px 15px;
      background: #f5f5f5;
      border: 2px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      user-select: none;
    }
    .tool-btn:active { transform: scale(0.95); }
    .tool-btn.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    #canvas {
      display: block;
      width: 100%;
      height: 400px;
      border: 2px solid #ddd;
      border-radius: 8px;
      touch-action: none;
      cursor: crosshair;
      background: #1a3a1a;
      background-image:
        radial-gradient(ellipse at 20% 30%, rgba(60,100,60,0.3) 0%, transparent 40%),
        radial-gradient(ellipse at 80% 70%, rgba(20,40,20,0.4) 0%, transparent 40%),
        radial-gradient(circle at 50% 50%, rgba(255,255,255,0.015) 0%, transparent 100%),
        repeating-linear-gradient(0deg, transparent, transparent 3px, rgba(255,255,255,0.008) 3px, rgba(255,255,255,0.008) 4px),
        repeating-linear-gradient(90deg, transparent, transparent 3px, rgba(255,255,255,0.005) 3px, rgba(255,255,255,0.005) 4px);
      box-shadow:
        inset 0 0 80px rgba(0,0,0,0.4),
        inset 10px 0 40px rgba(0,0,0,0.3),
        inset -10px 0 40px rgba(0,0,0,0.3);
      transition: all 0.5s ease;
    }
    .canvas-container.fullscreen #canvas {
      width: 100vw;
      height: calc(100vh - 70px);
      border: none;
      border-radius: 0;
    }

    /* ì•¡ì…˜ ë²„íŠ¼ */
    .action-buttons { 
      display: grid; 
      grid-template-columns: 1fr 1fr; 
      gap: 15px;
      transition: all 0.5s ease;
    }
    .action-buttons.hidden {
      opacity: 0;
      height: 0;
      overflow: hidden;
    }
    .action-buttons.fullscreen {
      position: fixed;
      bottom: 20px;
      left: 20px;
      right: 20px;
      z-index: 1001;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      opacity: 0.9;
    }
    .action-btn {
      padding: 18px;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      user-select: none;
    }
    .action-buttons.fullscreen .action-btn {
      padding: 12px 20px;
      font-size: 14px;
      border-radius: 8px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
    }
    .action-btn:active { transform: translateY(2px); box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
    .clear-btn { background: #ff6b6b; color: white; }
    .send-btn { background: #51cf66; color: white; }
    .send-btn:disabled { background: #ccc; cursor: not-allowed; }

    /* ìƒíƒœ ë©”ì‹œì§€ */
    .status-message {
      background: white;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      margin-top: 20px;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 2000;
      min-width: 300px;
    }
    .status-message.show { opacity: 1; transform: translate(-50%, -50%); }
    .status-message.success { background: linear-gradient(135deg, #51cf66, #37b24d); color: white; }
    .status-message.error { background: linear-gradient(135deg, #ff6b6b, #fa5252); color: white; }
    .status-message.sending { background: linear-gradient(135deg, #4c6ef5, #3b5bdb); color: white; }
    .status-icon { font-size: 48px; margin-bottom: 10px; }
    .status-title { font-size: 24px; font-weight: bold; margin-bottom: 10px; }
    .status-description { font-size: 14px; opacity: 0.9; }
  </style>
</head>
<body>
  <div class="container">
    <!-- ì—°ê²° ìƒíƒœ í—¤ë” -->
    <div class="header">
      <h1>ğŸ© ì¡°ìˆ˜ìš© ì†¡ì‹  ì•±</h1>
      
      <div class="connection-box">
        <div class="connection-code">
          <div class="code-label">ë¬´ëŒ€ ì•„ì´íŒ¨ë“œì— ì…ë ¥í•  ì½”ë“œ</div>
          <div class="code-value" id="connectionCode">------</div>
        </div>
        
        <div class="connection-status">
          <div class="status-dot" id="statusDot"></div>
          <span class="status-text" id="statusText">ì—°ê²° ì¤€ë¹„ ì¤‘...</span>
        </div>
      </div>
      
      <div class="network-guide">
        ğŸ’¡ <strong>ì‚¬ìš© ë°©ë²•:</strong><br>
        1. í•«ìŠ¤íŒŸ ì¼œê±°ë‚˜ ê°™ì€ Wi-Fiì— ì—°ê²°<br>
        2. ë¬´ëŒ€ ì•„ì´íŒ¨ë“œì—ì„œ ìœ„ ì½”ë“œ ì…ë ¥<br>
        3. ì—°ê²°ë˜ë©´ ì†ê¸€ì”¨ ì „ì†¡ ê°€ëŠ¥!
      </div>
    </div>

    <!-- ìº”ë²„ìŠ¤ ì˜ì—­ -->
    <div class="canvas-container">
      <div class="canvas-header">
        <h2>âœï¸ ì†ê¸€ì”¨ë¡œ ì ê¸°</h2>
        <div class="tool-buttons">
          <button class="tool-btn active" data-tool="pen" onclick="selectTool('pen')">í° ë¶„í•„</button>
          <button class="tool-btn" data-tool="thick" onclick="selectTool('thick')">êµµê²Œ</button>
          <button class="tool-btn" data-tool="eraser" onclick="selectTool('eraser')">ì§€ìš°ê°œ</button>
        </div>
      </div>
      <canvas id="canvas"></canvas>
    </div>

    <!-- ì•¡ì…˜ ë²„íŠ¼ -->
    <div class="action-buttons">
      <button class="action-btn clear-btn" onclick="clearCanvas()">ğŸ—‘ï¸ ì§€ìš°ê¸°</button>
      <button class="action-btn send-btn" id="sendBtn" onclick="sendHandwriting()" disabled>ğŸ“¤ ì „ì†¡í•˜ê¸°</button>
    </div>

    <!-- ìƒíƒœ ë©”ì‹œì§€ -->
    <div class="status-message" id="statusMessage">
      <div class="status-icon" id="statusIcon"></div>
      <div class="status-title" id="statusTitle"></div>
      <div class="status-description" id="statusDescription"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
  <script>
    // ì—°ê²° ì½”ë“œ ìƒì„±
    function generateCode() {
      const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // í—·ê°ˆë¦¬ëŠ” ë¬¸ì ì œì™¸
      let code = '';
      for (let i = 0; i < 6; i++) {
        code += chars[Math.floor(Math.random() * chars.length)];
      }
      return code;
    }

    const myCode = 'SENDER-' + generateCode();
    document.getElementById('connectionCode').textContent = myCode.replace('SENDER-', '');

    // PeerJS ì´ˆê¸°í™”
    let peer = null;
    let connection = null;
    let isConnected = false;

    try {
      peer = new Peer(myCode, {
        config: {
          iceServers: [
            { urls: 'stun:stun.l.google.com:19302' },
            { urls: 'stun:stun1.l.google.com:19302' }
          ]
        }
      });

      peer.on('open', (id) => {
        console.log('Peer ì¤€ë¹„ ì™„ë£Œ:', id);
        document.getElementById('statusText').textContent = 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œ ì—°ê²° ëŒ€ê¸° ì¤‘...';
        document.getElementById('statusDot').classList.add('waiting');
        showStatus('success', 'âœ“', 'ì¤€ë¹„ ì™„ë£Œ!', 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œì—ì„œ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”');
      });

      peer.on('connection', (conn) => {
        connection = conn;
        console.log('ì—°ê²° ì‹œë„ ê°ì§€');

        conn.on('open', () => {
          isConnected = true;
          document.getElementById('statusText').textContent = 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œì™€ ì—°ê²°ë¨ âœ“';
          document.getElementById('statusDot').classList.remove('waiting');
          document.getElementById('statusDot').classList.add('connected');
          document.getElementById('sendBtn').disabled = false;
          showStatus('success', 'ğŸ‰', 'ì—°ê²° ì„±ê³µ!', 'ì´ì œ ì†ê¸€ì”¨ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
          
          // 2ì´ˆ í›„ ì „ì²´í™”ë©´ ëª¨ë“œë¡œ ì „í™˜
          setTimeout(() => {
            enterFullscreenMode();
          }, 2000);
        });

        conn.on('close', () => {
          isConnected = false;
          document.getElementById('statusText').textContent = 'ì—°ê²° ëŠê¹€ - ì¬ì—°ê²° ëŒ€ê¸° ì¤‘...';
          document.getElementById('statusDot').classList.remove('connected');
          document.getElementById('statusDot').classList.add('waiting');
          document.getElementById('sendBtn').disabled = true;
          showStatus('error', 'âš ï¸', 'ì—°ê²° ëŠê¹€', 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œë¥¼ í™•ì¸í•˜ì„¸ìš”');
        });

        conn.on('error', (err) => {
          console.error('ì—°ê²° ì˜¤ë¥˜:', err);
        });
      });

      peer.on('error', (err) => {
        console.error('Peer ì˜¤ë¥˜:', err);
        showStatus('error', 'âŒ', 'ì˜¤ë¥˜ ë°œìƒ', err.message);
      });

    } catch (error) {
      console.error('PeerJS ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
      showStatus('error', 'âŒ', 'ì´ˆê¸°í™” ì‹¤íŒ¨', error.message);
    }

    // ìº”ë²„ìŠ¤ ì„¤ì •
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d', { willReadFrequently: false });
    let isDrawing = false;
    let currentTool = 'pen';
    let lastPos = null;
    let lastTime = 0;

    const chalk = {
      baseWidth: 15,
      thickWidth: 22,
      density: 40,
      spread: 0.1,
      roughness: 0.9
    };

    function rand(min, max) { return Math.random() * (max - min) + min; }
    function clamp(v, a, b) { return Math.max(a, Math.min(b, v)); }

    function setupCanvas() {
      const rect = canvas.getBoundingClientRect();
      
      // ì‹¤ì œ ë Œë”ë§ëœ í¬ê¸°ë¡œ ìº”ë²„ìŠ¤ ì„¤ì •
      canvas.width = Math.floor(rect.width);
      canvas.height = Math.floor(rect.height);
      
      // ë³€í™˜ ì´ˆê¸°í™”
      ctx.setTransform(1, 0, 0, 1, 0, 0);
      
      // ìº”ë²„ìŠ¤ë¥¼ íˆ¬ëª…í•˜ê²Œ ì´ˆê¸°í™”
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      console.log('ìº”ë²„ìŠ¤ í¬ê¸°:', canvas.width, 'x', canvas.height);
      console.log('CSS í¬ê¸°:', rect.width, 'x', rect.height);
    }

    setupCanvas();
    window.addEventListener('resize', setupCanvas);

    window.selectTool = function(tool) {
      currentTool = tool;
      document.querySelectorAll('.tool-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`[data-tool="${tool}"]`).classList.add('active');
    };

    function getPosition(e) {
      const rect = canvas.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      
      // í„°ì¹˜ ìœ„ì¹˜ ê³„ì‚°
      const x = clientX - rect.left;
      const y = clientY - rect.top;
      
      return { x, y };
    }

    function calcSpeed(p, t) {
      if (!lastPos) return 0.5;
      const dx = p.x - lastPos.x;
      const dy = p.y - lastPos.y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      const dt = Math.max(1, t - lastTime);
      return dist / dt;
    }

    function drawChalkParticles(x, y, w, speed) {
      const baseCount = (currentTool === 'thick') ? chalk.density * 1.5 : chalk.density;
      const count = Math.floor(baseCount * (1 + speed * 0.3));
      
      ctx.save();
      ctx.globalCompositeOperation = 'source-over';
      
      for (let i = 0; i < count; i++) {
        const u1 = Math.random();
        const u2 = Math.random();
        const gaussian = Math.sqrt(-2 * Math.log(u1)) * Math.cos(2 * Math.PI * u2);
        
        const spreadX = gaussian * w * chalk.spread * rand(0.35, 0.65);
        const spreadY = gaussian * w * chalk.spread * rand(0.35, 0.65);
        
        const px = x + spreadX;
        const py = y + spreadY;
        
        const distFromCenter = Math.sqrt(spreadX*spreadX + spreadY*spreadY);
        const maxDist = w * chalk.spread;
        const alphaFalloff = 1 - clamp(distFromCenter / maxDist, 0, 0.7);
        
        const size = rand(0.3, 2.0) * (currentTool === 'thick' ? 1.4 : 1.0);
        const baseAlpha = rand(0.15, 0.35) * alphaFalloff;
        
        const r = 230 + rand(-8, 5);
        const g = 235 + rand(-12, 6);
        const b = 228 + rand(-10, 8);
        
        ctx.fillStyle = `rgba(${r|0}, ${g|0}, ${b|0}, ${baseAlpha})`;
        
        if (Math.random() > 0.3) {
          ctx.beginPath();
          ctx.arc(px, py, size, 0, Math.PI * 2);
          ctx.fill();
        } else {
          ctx.fillRect(px - size/2, py - size/2, size * rand(0.8, 1.3), size * rand(0.8, 1.3));
        }
      }
      
      ctx.restore();
    }

    function startDrawing(e) {
      isDrawing = true;
      const pos = getPosition(e);
      lastPos = pos;
      lastTime = Date.now();
      
      if (currentTool !== 'eraser') {
        const w = (currentTool === 'thick') ? chalk.thickWidth : chalk.baseWidth;
        drawChalkParticles(pos.x, pos.y, w, 0);
      }
    }

    function draw(e) {
      if (!isDrawing) return;
      
      const pos = getPosition(e);
      const now = Date.now();
      
      if (currentTool === 'eraser') {
        ctx.save();
        ctx.globalCompositeOperation = 'destination-out';
        ctx.lineWidth = 40;
        ctx.lineCap = 'round';
        ctx.beginPath();
        ctx.moveTo(lastPos.x, lastPos.y);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
        ctx.restore();
        lastPos = pos;
        lastTime = now;
        return;
      }
      
      const speed = calcSpeed(pos, now);
      const w = (currentTool === 'thick') ? chalk.thickWidth : chalk.baseWidth;
      
      const dx = pos.x - lastPos.x;
      const dy = pos.y - lastPos.y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      const steps = Math.max(1, Math.floor(dist / 2));
      
      for (let i = 0; i <= steps; i++) {
        const t = i / steps;
        const ix = lastPos.x + dx * t;
        const iy = lastPos.y + dy * t;
        
        const jitterX = rand(-chalk.roughness, chalk.roughness);
        const jitterY = rand(-chalk.roughness, chalk.roughness);
        
        drawChalkParticles(ix + jitterX, iy + jitterY, w, speed);
      }
      
      lastPos = pos;
      lastTime = now;
    }

    function stopDrawing() {
      isDrawing = false;
      lastPos = null;
      lastTime = 0;
    }

    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
    canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startDrawing(e); }, { passive: false });
    canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); }, { passive: false });
    canvas.addEventListener('touchend', (e) => { e.preventDefault(); stopDrawing(); }, { passive: false });

    window.clearCanvas = function() {
      const rect = canvas.getBoundingClientRect();
      ctx.clearRect(0, 0, rect.width, rect.height);
      showStatus('success', 'ğŸ§½', 'ì§€ì›€ ì™„ë£Œ', 'ì¹ íŒì´ ê¹¨ë—í•´ì¡ŒìŠµë‹ˆë‹¤');
    };

    window.sendHandwriting = function() {
      if (!isConnected || !connection) {
        showStatus('error', 'âŒ', 'ì—°ê²° ì•ˆë¨', 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œì™€ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”');
        return;
      }
      
      showStatus('sending', 'ğŸ“¤', 'ì „ì†¡ì¤‘...', 'ì†ê¸€ì”¨ë¥¼ ë¬´ëŒ€ë¡œ ë³´ë‚´ê³  ìˆìŠµë‹ˆë‹¤');
      
      try {
        // ì†ê¸€ì”¨ë§Œ PNGë¡œ ì „ì†¡ (ë°°ê²½ íˆ¬ëª…)
        const imageData = canvas.toDataURL('image/png', 1.0);
        connection.send({
          type: 'handwriting',
          image: imageData,
          timestamp: Date.now()
        });
        
        console.log('ì†ê¸€ì”¨ ì „ì†¡ ì™„ë£Œ');
        showStatus('success', 'âœ“', 'ì „ì†¡ ì™„ë£Œ!', 'ë¬´ëŒ€ ì•„ì´íŒ¨ë“œê°€ ì†ê¸€ì”¨ë¥¼ ìˆ˜ì‹ í•©ë‹ˆë‹¤');
      } catch (error) {
        console.error('ì „ì†¡ ì˜¤ë¥˜:', error);
        showStatus('error', 'âŒ', 'ì „ì†¡ ì‹¤íŒ¨', error.message);
      }
    };

    function showStatus(type, icon, title, description) {
      const statusMessage = document.getElementById('statusMessage');
      const statusIcon = document.getElementById('statusIcon');
      const statusTitle = document.getElementById('statusTitle');
      const statusDescription = document.getElementById('statusDescription');
      statusMessage.className = `status-message show ${type}`;
      statusIcon.textContent = icon;
      statusTitle.textContent = title;
      statusDescription.textContent = description;
      setTimeout(() => statusMessage.classList.remove('show'), 3000);
    }

    // ì „ì²´í™”ë©´ ëª¨ë“œ ì§„ì…
    function enterFullscreenMode() {
      document.body.classList.add('fullscreen-mode');
      document.querySelector('.container').classList.add('fullscreen');
      document.querySelector('.header').classList.add('hidden');
      document.querySelector('.canvas-header').classList.add('hidden');
      document.querySelector('.canvas-container').classList.add('fullscreen');
      document.querySelector('.action-buttons').classList.add('fullscreen');
      
      // ì „ì²´í™”ë©´ ì „í™˜ í›„ ìº”ë²„ìŠ¤ í¬ê¸° ì¬ì¡°ì • (ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ í›„)
      setTimeout(() => {
        setupCanvas();
        console.log('ì „ì²´í™”ë©´ ëª¨ë“œ ì§„ì… - ìº”ë²„ìŠ¤ í¬ê¸° ì¬ì¡°ì • ì™„ë£Œ');
      }, 600);
    }

    // ì „ì²´í™”ë©´ ëª¨ë“œ í•´ì œ (í•„ìš”ì‹œ)
    function exitFullscreenMode() {
      document.body.classList.remove('fullscreen-mode');
      document.querySelector('.container').classList.remove('fullscreen');
      document.querySelector('.header').classList.remove('hidden');
      document.querySelector('.canvas-header').classList.remove('hidden');
      document.querySelector('.canvas-container').classList.remove('fullscreen');
      document.querySelector('.action-buttons').classList.remove('fullscreen');
      
      // ìº”ë²„ìŠ¤ í¬ê¸° ì¬ì¡°ì •
      setupCanvas();
      console.log('ì „ì²´í™”ë©´ ëª¨ë“œ í•´ì œ');
    }
  </script>
</body>
</html>
